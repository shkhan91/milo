<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test MPC API</title>
  <style>
    body { font-family: monospace; padding: 20px; }
    pre { background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto; }
    button { padding: 10px 20px; margin: 5px; cursor: pointer; }
    .success { color: green; }
    .error { color: red; }
  </style>
</head>
<body>
  <h1>MPC API Test</h1>
  <p>Testing Adobe MPC video API endpoints</p>
  
  <button onclick="testVideo('28729')">Test Video 28729</button>
  <button onclick="testVideo('16413')">Test Video 16413</button>
  <button onclick="testVideo('332595')">Test Video 332595</button>
  
  <div id="results"></div>
  
  <script type="module">
    window.testVideo = async function(videoId) {
      const results = document.getElementById('results');
      results.innerHTML = '<p>Loading...</p>';
      
      try {
        // Test metadata endpoint
        console.log(`Fetching metadata for ${videoId}...`);
        const metadataUrl = `https://video.tv.adobe.com/v/${videoId}?format=json-ld`;
        const metadataResponse = await fetch(metadataUrl);
        
        if (!metadataResponse.ok) {
          throw new Error(`Metadata API returned ${metadataResponse.status}`);
        }
        
        const metadata = await metadataResponse.json();
        
        // Test captions endpoint
        console.log(`Fetching captions for ${videoId}...`);
        const captionsUrl = `https://video.tv.adobe.com/vc/${videoId}/eng.json`;
        const captionsResponse = await fetch(captionsUrl);
        
        let captions = null;
        if (captionsResponse.ok) {
          captions = await captionsResponse.json();
        }
        
        results.innerHTML = `
          <h2 class="success">✓ Video ${videoId} Loaded Successfully</h2>
          
          <h3>Metadata:</h3>
          <ul>
            <li><strong>Title:</strong> ${metadata.name || 'N/A'}</li>
            <li><strong>Description:</strong> ${metadata.description || 'N/A'}</li>
            <li><strong>Duration:</strong> ${metadata.duration || 'N/A'}</li>
            <li><strong>Upload Date:</strong> ${metadata.uploadDate || 'N/A'}</li>
            <li><strong>Embed URL:</strong> ${metadata.embedUrl || 'N/A'}</li>
            <li><strong>Thumbnails:</strong> ${metadata.thumbnailUrl ? metadata.thumbnailUrl.length : 0} available</li>
            <li><strong>Has Chapters:</strong> ${metadata.hasPart && metadata.hasPart.length > 0 ? 'Yes (' + metadata.hasPart.length + ')' : 'No'}</li>
            <li><strong>Bucket ID:</strong> ${metadata.bucketId || 'N/A'}</li>
          </ul>
          
          <h3>Captions:</h3>
          <p>${captions ? '✓ Available (' + (Array.isArray(captions) ? captions.length : 'object') + ' entries)' : '✗ Not available'}</p>
          
          <h3>Thumbnail URLs:</h3>
          ${metadata.thumbnailUrl && metadata.thumbnailUrl.length > 0 ? `
            <ul>
              ${metadata.thumbnailUrl.map(url => `<li><a href="${url}" target="_blank">${url}</a></li>`).join('')}
            </ul>
            <img src="${metadata.thumbnailUrl[0]}" style="max-width: 400px;" alt="Thumbnail">
          ` : '<p>No thumbnails</p>'}
          
          <h3>Full Metadata Response:</h3>
          <pre>${JSON.stringify(metadata, null, 2)}</pre>
          
          ${captions ? `
            <h3>Caption Sample (first 3):</h3>
            <pre>${JSON.stringify(Array.isArray(captions) ? captions.slice(0, 3) : captions, null, 2)}</pre>
          ` : ''}
        `;
        
      } catch (error) {
        results.innerHTML = `
          <h2 class="error">✗ Error Loading Video ${videoId}</h2>
          <pre>${error.message}\n${error.stack}</pre>
        `;
        console.error('Test failed:', error);
      }
    };
  </script>
</body>
</html>

